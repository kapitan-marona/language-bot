--- a/voice.py
+++ b/voice.py
@@ -63,3 +63,60 @@
             continue
 
     raise RuntimeError("No available TTS voice for the selected language.")
+
+
+# === OpenAI TTS integration ===
+
+import openai
+import subprocess
+
+
+# Маппинг голосов по стилю общения
+VOICE_BY_STYLE = {
+    "casual": "alloy",
+    "business": "fable",
+    "story": "fable",
+    "default": "fable",
+}
+
+def select_voice(style: str) -> str:
+    return VOICE_BY_STYLE.get(style, VOICE_BY_STYLE['default'])
+
+def synthesize_voice_openai(text: str, voice: str = "alloy") -> str:
+    mp3_path = tempfile.mktemp(suffix=".mp3")
+    response = openai.audio.speech.create(
+        model="tts-1",
+        voice=voice,
+        input=text
+    )
+    with open(mp3_path, "wb") as f:
+        f.write(response.content)
+    return mp3_path
+
+def convert_mp3_to_ogg(mp3_path: str) -> str:
+    ogg_path = mp3_path.replace(".mp3", ".ogg")
+    command = [
+        "ffmpeg", "-y",
+        "-i", mp3_path,
+        "-c:a", "libopus",
+        "-b:a", "64k",
+        ogg_path
+    ]
+    subprocess.run(command, check=True)
+    return ogg_path
+
+
+# === Fallback wrapper for TTS ===
+
+
+def smart_synthesize_voice(text: str, lang: str, level: str, style: str = "default") -> str:
+    try:
+        voice = select_voice(style)
+        print(f"[TTS] Using OpenAI TTS voice: {voice}")
+        mp3_path = synthesize_voice_openai(text, voice)
+    except Exception as e:
+        print(f"[Fallback to Google TTS] OpenAI TTS failed: {e}")
+        mp3_path = synthesize_voice(text, lang, level)
+        print("[TTS] Used Google Cloud TTS instead")
+    return mp3_path
+
